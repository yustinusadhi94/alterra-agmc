version: '3'
services:
# namain sendiri
  backend:
    build:
      dockerfile: docker/Dockerfile
      context: .
    depends_on:
      - mysql
    image: 'alterra-agmc-day-7:latest'
    ports:
      - '8080:8080'
    networks:
      - infra
  mysql:
    image: 'mysql/mysql-server:5.7'
    restart: always
    ports:
      - '${FORWARD_MYSQL_DB_PORT:-3307}:3306'
    environment:
      MYSQL_ROOT_PASSWORD: 'root'
      MYSQL_ROOT_HOST: "%"
      MYSQL_DATABASE: '${DB_NAME:-alterra_agmc}'
      MYSQL_USER: 'admin'
      MYSQL_PASSWORD: 'admin'
      MYSQL_ALLOW_EMPTY_PASSWORD: 1
    volumes:
      - 'infra-mysql:/var/lib/mysql'
    networks:
      - infra
networks:
  infra:
    driver: bridge
volumes:
  infra-mysql:
    driver: local